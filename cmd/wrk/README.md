# HTTP Load Testing Tool

一个简单的 HTTP 负载测试工具，专注于 HTTP POST 请求的测试。

## 特性

- 支持并发请求
- 动态请求生成
  - 随机延迟范围
  - 自定义请求生成器
- 请求延迟统计（最小、最大、平均）
- QPS（每秒查询数）统计
- 失败请求计数
- 总传输字节统计
- 可配置的测试时间和并发数

## 代码组织

项目代码分为两个主要文件：

- `main.go`: 包含主要的压测逻辑
  - `Worker` 结构体：管理 HTTP 客户端和请求处理
  - 统计信息收集和报告
  - 命令行参数处理
- `generator.go`: 包含请求生成相关的代码
  - `RequestGenerator` 接口：定义请求生成的标准接口
  - `RandomDelayGenerator`: 生成随机延迟的请求
  - `CustomRequestGenerator`: 使用预定义请求列表的生成器

## 编译和运行

```bash
# 编译
go build -o wrk cmd/wrk/main.go

# 运行
./wrk -url http://localhost:8080/delay -c 100 -d 30 -min 50 -max 200
```

## 命令行参数

- `-url`: 目标URL (默认: http://localhost:8080/delay)
- `-c`: 并发数 (默认: 100)
- `-d`: 测试持续时间，单位秒 (默认: 30)
- `-min`: 最小延迟，单位毫秒 (默认: 50)
- `-max`: 最大延迟，单位毫秒 (默认: 200)

## 请求生成器

工具支持两种类型的请求生成器：

1. 随机延迟生成器（默认）
   - 为每个请求生成一个不同的延迟值
   - 延迟值在指定的最小值和最大值之间随机生成

2. 自定义请求生成器
   - 使用预定义的请求列表
   - 按顺序循环使用请求列表中的请求

## 输出说明

测试完成后，工具会输出以下统计信息：

- 总请求数：成功发送的请求总数
- 失败请求数：发送失败的请求数
- 每秒请求数：QPS
- 最小延迟：所有请求中的最小响应时间
- 最大延迟：所有请求中的最大响应时间
- 平均延迟：所有请求的平均响应时间
- 总传输字节：所有请求的总字节数

## 示例输出

```
开始压测 http://localhost:8080/delay
并发数: 100, 持续时间: 30秒
延迟范围: 50-200毫秒

压测结果:
总请求数: 15000
失败请求数: 0
每秒请求数: 500.00
最小延迟: 52ms
最大延迟: 198ms
平均延迟: 125ms
总传输字节: 150000
``` 